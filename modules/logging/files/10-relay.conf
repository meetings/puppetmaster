# /etc/rsyslog.d/10-network.conf - Network logging configuration
#
# This file is managed and overwritten by Puppet. If you need
# to make changes, see the Puppetmaster and its configuration.
#
# For more information, see /etc/rsyslog.conf.

##########################
###  DOMU RELAY RULES  ###
##########################

# Load udp listener.
#
$ModLoad imudp

# Create a new ruleset in which log messages received from
# domUs are forwarded to central logging servers.
#
$RuleSet remote

# Send everything in this ruleset to central logging servers
# (log-1, log-2 and elk).
#
*.* @@127.0.0.1:20147
*.* @@127.0.0.1:20149
*.* @@127.0.0.1:20074

# Bind this ruleset to UDP listener.
#
$InputUDPServerBindRuleset remote
$UDPServerRun 514

#####################
###  LOCAL RULES  ###
#####################

# Return to default ruleset to handle local messages.
#
$RuleSet RSYSLOG_DefaultRuleset

# Filter out some of the noise generated by portforwarding.
#
:msg, contains, "Accepted publickey for portforward from 10.0.0" ~
:msg, contains, "Received disconnect from 10.0.0" ~
:msg, contains, "session opened for user portforward" ~
:msg, contains, "session closed for user portforward" ~

# Send local messages to central logging servers.
#
*.* @@127.0.0.1:20147
*.* @@127.0.0.1:20149
